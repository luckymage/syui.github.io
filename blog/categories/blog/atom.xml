<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: blog | MBA-HACK2]]></title>
  <link href="http://syui.github.io/blog/categories/blog/atom.xml" rel="self"/>
  <link href="http://syui.github.io/"/>
  <updated>2014-07-02T05:32:30+09:00</updated>
  <id>http://syui.github.io/</id>
  <author>
    <name><![CDATA[syui]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Webの高速化を試してみた]]></title>
    <link href="http://syui.github.io/blog/2014/06/30/middleman-speed-test/"/>
    <updated>2014-06-30T00:00:00+09:00</updated>
    <id>http://syui.github.io/blog/2014/06/30/middleman-speed-test</id>
    <content type="html"><![CDATA[<p><img src="/images/more.png" alt="phoenix-power" align="left" width="100" height="100">Web高速化で一応、AAランクを目指してみました。<!--more--><br clear="all"></p>

<p><a href="http://syui.github.io/middleman/" target="_blank"><a href="http://syui.github.io/middleman/">http://syui.github.io/middleman/</a></a></p>

<p>テーマをイチから作るようなことをしてみました。ただし、シンプルなテンプレートをだいぶ参考にしていますが。</p>

<p>Webの高速化は、以下のサイトを見て、ダメな部分を削っていけば自然に<code>AA</code>ランクが取れます。</p>

<p><a href="http://gtmetrix.com/" target="_blank"><a href="http://gtmetrix.com/">http://gtmetrix.com/</a></a></p>

<p><img src="http://lh3.ggpht.com/-12FP-MgXCT4/U7AuRRPl82I/AAAAAAAAIeU/RbTgL_P-oH0/s0/%2525E3%252582%2525B9%2525E3%252582%2525AF%2525E3%252583%2525AA%2525E3%252583%2525BC%2525E3%252583%2525B3%2525E3%252582%2525B7%2525E3%252583%2525A7%2525E3%252583%252583%2525E3%252583%252588.png"></p>

<p>ただし、シンプルなテーマを選ぶか、イチから作るかでしか早期に達成するのは難しそうです。</p>

<p>今回は、以前から一度、シンプルなテーマを作ってみたかったこともあり、一石二鳥でしたが、分からない所もたくさんありました。</p>

<p>まず、 Middleman で一般的に使われている変数がまとまっていないので、ソースを見ていくしかなかったです。</p>

<p>また、 PATH と HOVER が難しかったです。</p>

<p>例えば、個別記事全体にリンクを貼るにも、プロジェクトページを使っていると、<code>/(root)</code>の記述が使えないため、 PATH 設定が困難を極めるなどしました。しかも、これは、プレビューで確認する事ができない。(推測はできますが</p>

<p>なんとか対応した形が以下の通りです。</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'><figcaption><span>source/index.html.erb</span></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'><span class="ni">&amp;lt;</span>% page_articles.each_with_index do |article, i| %&gt;
</span><span class='line'><span class="ni">&amp;lt;</span>% if i &gt; 0 %&gt;<span class="nt">&lt;/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="nt">&lt;pre&gt;&lt;code&gt;</span><span class="ni">&amp;lt;</span>div class=&quot;articles&quot; onclick=&quot;location.href=<span class="ni">&amp;amp;</span>#34;.<span class="ni">&amp;lt;</span>%= article.url %<span class="ni">&amp;gt;&amp;amp;</span>#34;;&quot; style=&quot;cursor: pointer;&quot;<span class="ni">&amp;gt;</span>
</span><span class='line'><span class="ni">&amp;lt;</span>/div<span class="ni">&amp;gt;</span>
</span><span class='line'><span class="nt">&lt;/code&gt;&lt;/pre&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="nt">&lt;p&gt;</span><span class="ni">&amp;lt;</span>% end %&gt;<span class="nt">&lt;/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="nt">&lt;pre&gt;&lt;code&gt;</span><span class="ni">&amp;lt;</span>div class=&quot;articles&quot; onclick=&quot;location.href=<span class="ni">&amp;amp;</span>#34;.<span class="ni">&amp;lt;</span>%= article.url %<span class="ni">&amp;gt;&amp;amp;</span>#34;;&quot; style=&quot;cursor: pointer;&quot;<span class="ni">&amp;gt;</span>
</span><span class='line'>    <span class="ni">&amp;lt;</span>%= partial &#39;/blog/article&#39;, :locals =<span class="ni">&amp;gt;</span> {:article =<span class="ni">&amp;gt;</span> article, :digest =<span class="ni">&amp;gt;</span> true} %<span class="ni">&amp;gt;</span>
</span><span class='line'><span class="ni">&amp;lt;</span>/div<span class="ni">&amp;gt;</span>
</span><span class='line'><span class="nt">&lt;/code&gt;&lt;/pre&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="nt">&lt;p&gt;</span><span class="ni">&amp;lt;</span>% end %&gt;
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>しかし、タグページだと、何故か URL が二重になるため<code>.</code>が使えませんでした。よって、<code>site_url</code>を使います。</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'><figcaption><span>source/layouts/tag.html.erb </span></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'><span class="nt">&lt;/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="nt">&lt;ul</span> <span class="na">class=</span><span class="s">&quot;breadcrumbs&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>    <span class="nt">&lt;li&gt;&lt;a</span> <span class="na">href=</span><span class="s">&quot;&lt;%= site_url %&gt;&quot;</span><span class="nt">&gt;&lt;span</span> <span class="na">class=</span><span class="s">&quot;icon-home&quot;</span><span class="nt">&gt;&lt;/span&gt;&lt;/a&gt;&lt;/li&gt;</span>
</span><span class='line'>  <span class="nt">&lt;li</span> <span class="na">class=</span><span class="s">&quot;current&quot;</span><span class="nt">&gt;&lt;a</span> <span class="na">href=</span><span class="s">&quot;&lt;%= tag_path tagname %&gt;&quot;</span><span class="nt">&gt;</span><span class="err">&lt;</span>%= tagname %&gt;<span class="nt">&lt;/a&gt;&lt;/li&gt;</span>
</span><span class='line'><span class="nt">&lt;/ul&gt;</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'><span class="nt">&lt;p&gt;</span>  <span class="ni">&amp;lt;</span>% page_articles.each_with_index do |article, i| %&gt;<span class="nt">&lt;/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="nt">&lt;pre&gt;&lt;code&gt;</span><span class="ni">&amp;lt;</span>% if i <span class="ni">&amp;gt;</span> 0 %<span class="ni">&amp;gt;</span>
</span><span class='line'><span class="ni">&amp;lt;</span>div class=&quot;articles&quot; onclick=&quot;location.href=<span class="ni">&amp;amp;</span>#34;<span class="ni">&amp;lt;</span>%= site_url %<span class="ni">&amp;gt;&amp;lt;</span>%= article.url %<span class="ni">&amp;gt;&amp;amp;</span>#34;;&quot; style=&quot;cursor: pointer;&quot;<span class="ni">&amp;gt;</span>
</span><span class='line'><span class="ni">&amp;lt;</span>/div<span class="ni">&amp;gt;</span>
</span><span class='line'><span class="ni">&amp;lt;</span>% end %<span class="ni">&amp;gt;</span>
</span><span class='line'><span class="ni">&amp;lt;</span>div class=&quot;articles&quot; onclick=&quot;location.href=<span class="ni">&amp;amp;</span>#34;<span class="ni">&amp;lt;</span>%= site_url %<span class="ni">&amp;gt;&amp;lt;</span>%= article.url %<span class="ni">&amp;gt;&amp;amp;</span>#34;;&quot; style=&quot;cursor: pointer;&quot;<span class="ni">&amp;gt;</span>
</span><span class='line'>    <span class="ni">&amp;lt;</span>%= partial &#39;/blog/article&#39;, :locals =<span class="ni">&amp;gt;</span> {:article =<span class="ni">&amp;gt;</span> article, :digest =<span class="ni">&amp;gt;</span> true} %<span class="ni">&amp;gt;</span>
</span><span class='line'><span class="ni">&amp;lt;</span>/div<span class="ni">&amp;gt;</span>
</span><span class='line'><span class="nt">&lt;/code&gt;&lt;/pre&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="nt">&lt;p&gt;</span>  <span class="ni">&amp;lt;</span>% end %&gt;
</span></code></pre></td></tr></table></div></figure></notextile></div></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Middlemanのテンプレートを使うときのarticle.url]]></title>
    <link href="http://syui.github.io/blog/2014/06/28/middleman-slim-theme/"/>
    <updated>2014-06-28T00:00:00+09:00</updated>
    <id>http://syui.github.io/blog/2014/06/28/middleman-slim-theme</id>
    <content type="html"><![CDATA[<p><img src="/images/more.png" alt="phoenix-power" align="left" width="100" height="100">めちゃくちゃハマりました。何故か、 article.url だけ先頭に / が来る仕様で、プロジェクトページを使った場合にパスの記述が上手くいかない問題について。<!--more--><br clear="all"></p>

<h2>一般的なpathの問題</h2>

<blockquote><p>問題 : 私は、ルートをOctopressで構築しているため、<code>/middleman</code>以下にページを作成することを考えました。しかし、デフォルトの設定では、なかなかパス設定が上手く行きませんでした。</p></blockquote>

<p>上手く言った設定は以下の通り。<code>asset_hash</code>を設定してやると良いみたいです。</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'><figcaption><span>./config.rb </span></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">set</span> <span class="ss">:site_url</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">lsquo</span><span class="p">;</span><span class="o">&lt;</span><span class="n">a</span> <span class="n">href</span><span class="o">=</span><span class="s2">&quot;http://syui.github.io/middleman&quot;</span><span class="o">&gt;</span><span class="ss">http</span><span class="p">:</span><span class="sr">//s</span><span class="n">yui</span><span class="o">.</span><span class="n">github</span><span class="o">.</span><span class="n">io</span><span class="o">/</span><span class="n">middleman</span><span class="o">&lt;</span><span class="sr">/a&gt;&amp;rsquo;&lt;/</span><span class="nb">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="nb">p</span><span class="o">&gt;</span><span class="n">activate</span> <span class="ss">:blog</span> <span class="k">do</span> <span class="o">|</span><span class="n">blog</span><span class="o">|</span>
</span><span class='line'>  <span class="n">blog</span><span class="o">.</span><span class="n">prefix</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">ldquo</span><span class="p">;</span><span class="n">blog</span><span class="o">&amp;</span><span class="n">rdquo</span><span class="p">;</span>
</span><span class='line'>  <span class="c1">#blog.sources = &amp;ldquo;{year}&amp;ndash;{month}&amp;ndash;{day}&amp;ndash;{title}.html&amp;rdquo;</span>
</span><span class='line'>  <span class="n">blog</span><span class="o">.</span><span class="n">tag_template</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">ldquo</span><span class="p">;</span><span class="n">tag</span><span class="o">.</span><span class="n">html</span><span class="o">&amp;</span><span class="n">rdquo</span><span class="p">;</span>
</span><span class='line'>  <span class="n">blog</span><span class="o">.</span><span class="n">calendar_template</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">ldquo</span><span class="p">;</span><span class="n">calendar</span><span class="o">.</span><span class="n">html</span><span class="o">&amp;</span><span class="n">rdquo</span><span class="p">;</span>
</span><span class='line'><span class="k">end</span><span class="o">&lt;</span><span class="sr">/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="sr">&lt;p&gt;configure :build do</span>
</span><span class='line'><span class="sr">  activate :asset_host, :host =&gt; &amp;ldquo;/mi</span><span class="n">ddleman</span><span class="o">&amp;</span><span class="n">rdquo</span><span class="p">;</span>
</span><span class='line'>  <span class="n">activate</span> <span class="ss">:asset_hash</span>
</span><span class='line'>  <span class="n">set</span> <span class="ss">:relative_links</span><span class="p">,</span> <span class="kp">true</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>更に、ところどころに<code>/</code>をそのまま記述しているところがあったので、<code>$ grep -R "'/'" .</code>など検索をして、その箇所を<code>#{site_url}</code>に変更しました。</p>

<p>ちなみに、 Middleman の記事は、<code>$ middleman article TITLE</code>で作成し、上記の設定だと<code>syui.github.io/middleman/blog</code>以下にポストされます。</p>

<p>この辺り、<code>blog.prefix</code>をプロジェクト名にするのだと勘違いしていました。</p>

<h2>article.urlの問題</h2>

<blockquote><p>問題 : プレビューでは上手くアクセスできているのに、実際に公開されると、「続きを読む」のリンクからはアクセス出来ない現象が起こりました。</p></blockquote>

<p>そこで、<code>./build/index.html</code>をみてみると、<code>続きを読む</code>のところだけ、リンクの先頭に<code>/</code>が来ているようでした。</p>

<p>したがって、<code>./source/index.html.slim</code>を確認してみると、どうやら個別記事の URL が入っている<code>article.url</code>を使っているみたいでした。</p>

<p>つまり、通常の略式記述では、<code>{tag}/{title}.html</code>となるところが、<code>article.url</code>だと、<code>/tag/title.html</code>となってしまているのです。</p>

<p>時間がかかった理由としては、プレビューで確認できませんできないため、<code>push</code>しまくって地道に確認していくやりかたしか思いつきませんでした。</p>

<p>また、最初なので、<a href="https://github.com/yterajima/middleman-slim">slim</a>の記述から何から何までよくわかりませんでした。</p>

<p>最終的には、<code>article.url</code>の辺りを以下のように変更しました。具体的には、<code>link_to article</code>を使います。</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'><figcaption><span>./source/*.slim </span></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'>  = article.summary
</span><span class='line'>  = link_to <span class="ni">&amp;lsquo;</span>Read more…<span class="ni">&amp;rsquo;</span>, article
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>とりあえず、応急処置としてはこんな感じで。疲れました&hellip;。</p>

<p><a href="http://syui.github.io/middleman/">http://syui.github.io/middleman/</a></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Middlemanのブログテンプレートを使ってみた]]></title>
    <link href="http://syui.github.io/blog/2014/06/28/middleman-blog-template/"/>
    <updated>2014-06-28T00:00:00+09:00</updated>
    <id>http://syui.github.io/blog/2014/06/28/middleman-blog-template</id>
    <content type="html"><![CDATA[<p><img src="/images/more.png" alt="phoenix-power" align="left" width="100" height="100">Middlemanでブログを構築するのは思った以上に簡単でした。<!--more--><br clear="all"></p>

<h2>Middlemanについて</h2>

<p><a href="http://directory.middlemanapp.com/">Middleman</a> とは、 <a href="http://octopress.org/">Octopress</a> 同様、コマンドラインから静的ページを簡単に構築するためのツールです。</p>

<p><a href="http://directory.middlemanapp.com/#/templates/all">Template</a> も豊富で、 Octopress よりも手順が簡略化され、かつ各モジュールのバージョンも最新に近い状態なので、人気があります。</p>

<h3>middleman-blog-bootstrap-template</h3>

<h4>テンプレートのインストール</h4>

<p>今回は、<a href="https://github.com/biblichor/middleman-blog-bootstrap-template">middleman-blog-bootstrap-template</a> というテーマを使ってみます。</p>

<p>Ruby のバージョンは、<code>2.1.2</code>を使うことにします。このテンプレートでは、<a href="https://github.com/bower/bower">bower</a>も使っているようですね。</p>

<p>テンプレートを使うための手順は、まず、<code>~/.middleman</code>以下のディレクトリにテンプレートを置きます。そして、そのディレクトリ名で<code>middleman init プロジェクト名 --template=テンプレートのディレクトリ名</code>というコマンドを実行します。</p>

<p>すると、プロジェクト名のディレクトリが現在ディレクトリに作成されますので、その中から<code>middleman</code>の各種コマンドを実行します。</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>rvm install 2.1.2&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;<span class="nv">$ </span>rvm use 2.1.2&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;<span class="nv">$ </span>gem install middleman&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;<span class="nv">$ </span>git clone &lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;https://github.com/biblichor/middleman-blog-bootstrap-template.git&quot;</span>&gt;https://github.com/biblichor/middleman-blog-bootstrap-template.git&lt;/a&gt; ~/.middleman/blog-bootstrap&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;<span class="nv">$ </span>middleman init my_new_project &amp;mdash;template<span class="o">=</span>blog-bootstrap&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;<span class="nv">$ </span><span class="nb">cd </span>my_new_project&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;<span class="nv">$ </span>bundle&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;<span class="nv">$ </span>npm install -g bower&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;<span class="nv">$ </span>bower install
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<h4>Gemfile</h4>

<p>必要なモジュールは、<code>Gemfile</code>に書き、<code>bundle install</code>で導入します。</p>

<p>現時点では以下の様な感じです。<code>Markdonw</code>や<code>Syntax-Highlighting</code>などを使いたい場合は、各自導入する必要があります。たぶん。</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'><figcaption><span>./Gemfile </span></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="o">&lt;</span><span class="sr">/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="sr">&lt;h1&gt;If you have OpenSSL installed, we recommend updating&lt;/</span><span class="n">h1</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">h1</span><span class="o">&gt;</span><span class="n">the</span> <span class="n">following</span> <span class="n">line</span> <span class="n">to</span> <span class="n">use</span> <span class="o">&amp;</span><span class="n">ldquo</span><span class="p">;</span><span class="n">https</span><span class="o">&amp;</span><span class="n">rdquo</span><span class="p">;</span><span class="o">&lt;</span><span class="sr">/h1&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="sr">&lt;p&gt;source &amp;lsquo;&lt;a href=&quot;http:/</span><span class="o">/</span><span class="n">rubygems</span><span class="o">.</span><span class="n">org</span><span class="s2">&quot;&gt;http://rubygems.org&lt;/a&gt;&amp;rsquo;&lt;/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="s2">&lt;p&gt;gem &amp;ldquo;middleman&amp;rdquo;, &amp;ldquo;~&gt; 3.2.2&amp;rdquo;</span>
</span><span class='line'><span class="s2">gem &amp;ldquo;middleman-blog&amp;rdquo;, &amp;ldquo;~&gt; 3.5.1&amp;rdquo;</span>
</span><span class='line'><span class="s2">gem &amp;ldquo;middleman-target&amp;rdquo;, &amp;ldquo;~&gt; 0.0.6&amp;rdquo;</span>
</span><span class='line'><span class="s2">gem &amp;ldquo;middleman-deploy&amp;rdquo;, &amp;ldquo;~&gt; 0.1.4&amp;rdquo;&lt;/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="s2">&lt;h1&gt;Live-reloading plugin&lt;/h1&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="s2">&lt;p&gt;gem &amp;ldquo;middleman-livereload&amp;rdquo;, &amp;ldquo;~&gt; 3.1.0&amp;rdquo;&lt;/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="s2">&lt;h1&gt;For Slim&lt;/h1&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="s2">&lt;p&gt;gem &amp;ldquo;slim&amp;rdquo;, &amp;ldquo;~&gt; 2.0.2&amp;rdquo;&lt;/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="s2">&lt;h1&gt;For Markdown&lt;/h1&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="s2">&lt;p&gt;gem &amp;ldquo;redcarpet&amp;rdquo;, &amp;ldquo;~&gt; 3.1.1&amp;rdquo;&lt;/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="s2">&lt;h1&gt;For blog summary&lt;/h1&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="s2">&lt;p&gt;gem &amp;ldquo;nokogiri&amp;rdquo;, &amp;ldquo;~&gt; 1.6.1&amp;rdquo;&lt;/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="s2">&lt;h1&gt;For feed.xml.builder/sitemap.xml.builder&lt;/h1&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="s2">&lt;p&gt;gem &amp;ldquo;builder&amp;rdquo;, &amp;ldquo;~&gt; 3.0&amp;rdquo;</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<h4>config.rb</h4>

<p>設定は、<code>config.rb</code>に書きます。とりあえずは、デプロイ簡易化の設定を書いておきます。</p>

<p>なお、デプロイ簡易化の設定は、<code>gem "middleman-deploy"</code>モジュールが必要になります。</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'><figcaption><span>./config.rb </span></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">configure</span> <span class="ss">:build</span> <span class="k">do</span>
</span><span class='line'>  <span class="c1"># For example, change the Compass output style for deployment</span>
</span><span class='line'>  <span class="n">activate</span> <span class="ss">:asset_host</span><span class="p">,</span> <span class="ss">:host</span> <span class="o">=&gt;</span> <span class="o">&amp;</span><span class="n">ldquo</span><span class="p">;</span><span class="o">/</span><span class="n">middleman</span><span class="o">&amp;</span><span class="n">rdquo</span><span class="p">;</span>
</span><span class='line'>  <span class="n">activate</span> <span class="ss">:minify_css</span><span class="o">&lt;</span><span class="sr">/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="sr">&lt;p&gt;  # Minify Javascript on build</span>
</span><span class='line'><span class="sr">  activate :minify_javascript&lt;/</span><span class="nb">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="nb">p</span><span class="o">&gt;</span>  <span class="c1"># Enable cache buster</span>
</span><span class='line'>  <span class="c1"># activate :asset_hash&lt;/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="nb">p</span><span class="o">&gt;</span>  <span class="c1"># Use relative URLs</span>
</span><span class='line'>  <span class="n">activate</span> <span class="ss">:relative_assets</span>
</span><span class='line'>  <span class="n">set</span> <span class="ss">:relative_links</span><span class="p">,</span> <span class="kp">true</span>
</span><span class='line'><span class="k">end</span><span class="o">&lt;</span><span class="sr">/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="sr">&lt;p&gt;  # Or use a different image path</span>
</span><span class='line'><span class="sr">  # set :http_prefix, &amp;ldquo;/</span><span class="no">Content</span><span class="o">/</span><span class="n">images</span><span class="o">/&amp;</span><span class="n">rdquo</span><span class="p">;</span>
</span><span class='line'>  <span class="n">activate</span> <span class="ss">:deploy</span> <span class="k">do</span> <span class="o">|</span><span class="n">deploy</span><span class="o">|</span>
</span><span class='line'>  <span class="n">deploy</span><span class="o">.</span><span class="n">build_before</span> <span class="o">=</span> <span class="kp">true</span>
</span><span class='line'>  <span class="n">deploy</span><span class="o">.</span><span class="n">method</span> <span class="o">=</span> <span class="ss">:git</span>
</span><span class='line'>  <span class="n">deploy</span><span class="o">.</span><span class="n">branch</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">lsquo</span><span class="p">;</span><span class="n">gh</span><span class="o">-</span><span class="n">pages</span><span class="o">&amp;</span><span class="n">rsquo</span><span class="p">;</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>ちなみに、デフォルトでは<code>#root</code>が<code>source/foo/index.html.erb</code>の中から相対パスなので、<code>link_to</code>で作られるあらゆる URL を相対パスにしたい場合の設定は以下の通りです。</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'><figcaption><span>./config.rb <a href="https://github.com/neo/middleman-gh-pages">https://github.com/neo/middleman-gh-pages</a> LINK </span></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>activate :relative_assets
</span><span class='line'><span class="nb">set</span> :relative_links, <span class="nb">true</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>私の場合は、<code>root</code>では、 Octopress を展開させていますので、以下のように書きます。ただし、これは、 GitHub Pages で構築するページの通常の設定ではありません。</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'><figcaption><span>./config.rb <a href="http://middlemanapp.com/jp/basics/helpers/">http://middlemanapp.com/jp/basics/helpers/</a> LINK </span></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;h1&gt;Use relative URLs&lt;/h1&gt;
</span><span class='line'>
</span><span class='line'>&lt;h1&gt;activate :directory_indexes&lt;/h1&gt;
</span><span class='line'>
</span><span class='line'>&lt;h1&gt;activate :relative_assets&lt;/h1&gt;
</span><span class='line'>
</span><span class='line'>&lt;h1&gt;set :relative_links, <span class="nb">true</span>&lt;/h1&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>参考:</p>

<p><a href="http://middlemanapp.com/jp/basics/blogging/">http://middlemanapp.com/jp/basics/blogging/</a></p>

<h4>テンプレートのプレビューやビルド</h4>

<p><div class='bogus-wrapper'><notextile><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;h1&gt;現在のディレクトリにある <span class="nb">source</span> フォルダをプレビューを行うコマンド<span class="o">(</span>&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;http://localhost:4567/&quot;</span>&gt;http://localhost:4567/&lt;/a&gt;<span class="o">)</span>&lt;/h1&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;<span class="nv">$ </span>middleman server&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;h1&gt;現在ディレクトリの <span class="nb">source</span> フォルダ build フォルダ内に HTML 変換するコマンド&lt;/h1&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;<span class="nv">$ </span>middleman build&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;h1&gt;指定されたホストにデプロイするコマンド&lt;/h1&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;<span class="nv">$ </span>middleman deploy
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>現時点では、一応こんな感じのテンプレートみたいです。</p>

<p><img src="http://lh4.ggpht.com/-6ojZW4fDSxg/U647_sSnRYI/AAAAAAAAIdo/IK9J0bus8Ws/s0/%2525E3%252582%2525B9%2525E3%252582%2525AF%2525E3%252583%2525AA%2525E3%252583%2525BC%2525E3%252583%2525B3%2525E3%252582%2525B7%2525E3%252583%2525A7%2525E3%252583%252583%2525E3%252583%252588.png"></p>

<p>デプロイが上手くいかない場合は、<a href="http://syui.org/blog/2014/06/23/blog-github-middleman/">こちら</a>の記事を参考にしてください。</p>

<h4>Middlemanのzsh completions</h4>

<p><code>zsh</code>の補完が効かなかったので、探してみました。こういうのは大体公式リポジトリに置いてあるので、インストールフォルダ探せば見つかるような気もしますが。</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span><span class="nb">cd</span> ~/.zsh/functions/&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;<span class="nv">$ </span>curl -O &lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;https://raw.githubusercontent.com/sshankar/dotx/master/.zsh/completions/_middleman&quot;</span>&gt;https://raw.githubusercontent.com/sshankar/dotx/master/.zsh/completions/_middleman&lt;/a&gt;&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;<span class="nv">$ </span><span class="nb">source</span> ~/.zshrc
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p><img src="http://lh6.ggpht.com/-oSkoV7LLmkY/U649ncG2o0I/AAAAAAAAId0/WWp2z2Cq3_k/s0/%2525E3%252582%2525B9%2525E3%252582%2525AF%2525E3%252583%2525AA%2525E3%252583%2525BC%2525E3%252583%2525B3%2525E3%252582%2525B7%2525E3%252583%2525A7%2525E3%252583%252583%2525E3%252583%252588.png"></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Octopressのgist_tag.rbが動作しない問題について]]></title>
    <link href="http://syui.github.io/blog/2014/06/23/octopress-gist-tag/"/>
    <updated>2014-06-23T01:44:34+09:00</updated>
    <id>http://syui.github.io/blog/2014/06/23/octopress-gist-tag</id>
    <content type="html"><![CDATA[<p><img src="/images/more.png" alt="phoenix-power" align="left" width="100" height="100">Octopress に入ってる Gist Tag Plugin は動作しないようです。<!--more--><br clear="all"></p>

<p><a href="https://github.com/octopress/octopress-gist">octopress-gist</a></p>

<p>ということで、以下のコードを参考に書き直します。</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span><span class="nb">cd</span> ~/octopress/source/plugins/&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;<span class="nv">$ </span>curl -O &lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;https://gist.githubusercontent.com/j5ik2o/5550083/raw/gist_tag.rb&quot;</span>&gt;https://gist.githubusercontent.com/j5ik2o/5550083/raw/gist_tag.rb&lt;/a&gt;
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p><div class='bogus-wrapper'><notextile><figure class='code'><figcaption><span>Octopress Gist Tag プラグイン 改造版</span><a target='_blank' href='https://gist.github.com/5550083'><span class='mega-octicon octicon-code' style='font-size:30px;'></span></a></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
<span class='line-number'>71</span>
<span class='line-number'>72</span>
<span class='line-number'>73</span>
<span class='line-number'>74</span>
<span class='line-number'>75</span>
<span class='line-number'>76</span>
<span class='line-number'>77</span>
<span class='line-number'>78</span>
<span class='line-number'>79</span>
<span class='line-number'>80</span>
<span class='line-number'>81</span>
<span class='line-number'>82</span>
<span class='line-number'>83</span>
<span class='line-number'>84</span>
<span class='line-number'>85</span>
<span class='line-number'>86</span>
<span class='line-number'>87</span>
<span class='line-number'>88</span>
<span class='line-number'>89</span>
<span class='line-number'>90</span>
<span class='line-number'>91</span>
<span class='line-number'>92</span>
<span class='line-number'>93</span>
<span class='line-number'>94</span>
<span class='line-number'>95</span>
<span class='line-number'>96</span>
<span class='line-number'>97</span>
<span class='line-number'>98</span>
<span class='line-number'>99</span>
<span class='line-number'>100</span>
<span class='line-number'>101</span>
<span class='line-number'>102</span>
<span class='line-number'>103</span>
<span class='line-number'>104</span>
<span class='line-number'>105</span>
<span class='line-number'>106</span>
<span class='line-number'>107</span>
<span class='line-number'>108</span>
<span class='line-number'>109</span>
<span class='line-number'>110</span>
<span class='line-number'>111</span>
<span class='line-number'>112</span>
<span class='line-number'>113</span>
<span class='line-number'>114</span>
<span class='line-number'>115</span>
<span class='line-number'>116</span>
<span class='line-number'>117</span>
<span class='line-number'>118</span>
<span class='line-number'>119</span>
<span class='line-number'>120</span>
<span class='line-number'>121</span>
<span class='line-number'>122</span>
<span class='line-number'>123</span>
<span class='line-number'>124</span>
<span class='line-number'>125</span>
<span class='line-number'>126</span>
<span class='line-number'>127</span>
<span class='line-number'>128</span>
<span class='line-number'>129</span>
<span class='line-number'>130</span>
<span class='line-number'>131</span>
<span class='line-number'>132</span>
<span class='line-number'>133</span>
<span class='line-number'>134</span>
<span class='line-number'>135</span>
<span class='line-number'>136</span>
<span class='line-number'>137</span>
<span class='line-number'>138</span>
<span class='line-number'>139</span>
<span class='line-number'>140</span>
<span class='line-number'>141</span>
<span class='line-number'>142</span>
<span class='line-number'>143</span>
<span class='line-number'>144</span>
<span class='line-number'>145</span>
<span class='line-number'>146</span>
<span class='line-number'>147</span>
<span class='line-number'>148</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="c1"># A Liquid tag for Jekyll sites that allows embedding Gists and showing code for non-JavaScript enabled browsers and readers.</span>
</span><span class='line'><span class="c1"># by: Brandon Tilly</span>
</span><span class='line'><span class="c1"># Source URL: https://gist.github.com/1027674</span>
</span><span class='line'><span class="c1"># Post http://brandontilley.com/2011/01/31/gist-tag-for-jekyll.html</span>
</span><span class='line'><span class="c1">#</span>
</span><span class='line'><span class="c1"># Example usage: {% gist 1027674 gist_tag.rb %} //embeds a gist for this plugin</span>
</span><span class='line'>
</span><span class='line'><span class="nb">require</span> <span class="s1">&#39;cgi&#39;</span>
</span><span class='line'><span class="nb">require</span> <span class="s1">&#39;digest/md5&#39;</span>
</span><span class='line'><span class="nb">require</span> <span class="s1">&#39;net/https&#39;</span>
</span><span class='line'><span class="nb">require</span> <span class="s1">&#39;uri&#39;</span>
</span><span class='line'><span class="nb">require</span> <span class="s1">&#39;json&#39;</span>
</span><span class='line'>
</span><span class='line'><span class="nb">require</span> <span class="s1">&#39;./plugins/pygments_code&#39;</span>
</span><span class='line'><span class="nb">require</span> <span class="s1">&#39;./plugins/raw&#39;</span>
</span><span class='line'><span class="nb">require</span> <span class="s1">&#39;./plugins/octopress_filters&#39;</span>
</span><span class='line'>
</span><span class='line'><span class="k">module</span> <span class="nn">Jekyll</span>
</span><span class='line'>  <span class="k">class</span> <span class="nc">GistTag</span> <span class="o">&lt;</span> <span class="ss">Liquid</span><span class="p">:</span><span class="ss">:Tag</span>
</span><span class='line'>    <span class="kp">include</span> <span class="no">HighlightCode</span>
</span><span class='line'>    <span class="kp">include</span> <span class="no">TemplateWrapper</span>
</span><span class='line'>    <span class="kp">include</span> <span class="no">OctopressFilters</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">def</span> <span class="nf">initialize</span><span class="p">(</span><span class="n">tag_name</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">token</span><span class="p">)</span>
</span><span class='line'>      <span class="vi">@title</span> <span class="o">=</span> <span class="kp">nil</span>
</span><span class='line'>      <span class="vi">@caption</span> <span class="o">=</span> <span class="kp">nil</span>
</span><span class='line'>      <span class="vi">@highlight</span> <span class="o">=</span> <span class="kp">true</span>
</span><span class='line'>      <span class="k">super</span>
</span><span class='line'>      <span class="vi">@text</span>           <span class="o">=</span> <span class="n">text</span>
</span><span class='line'>      <span class="vi">@cache_disabled</span> <span class="o">=</span> <span class="kp">false</span>
</span><span class='line'>      <span class="vi">@cache_folder</span>   <span class="o">=</span> <span class="no">File</span><span class="o">.</span><span class="n">expand_path</span> <span class="s2">&quot;../.gist-cache&quot;</span><span class="p">,</span> <span class="no">File</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="bp">__FILE__</span><span class="p">)</span>
</span><span class='line'>      <span class="no">FileUtils</span><span class="o">.</span><span class="n">mkdir_p</span> <span class="vi">@cache_folder</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">def</span> <span class="nf">render</span><span class="p">(</span><span class="n">context</span><span class="p">)</span>
</span><span class='line'>      <span class="k">if</span> <span class="n">parts</span> <span class="o">=</span> <span class="vi">@text</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="sr">/([\d]*) (.*)/</span><span class="p">)</span>
</span><span class='line'>        <span class="n">output</span> <span class="o">=</span> <span class="k">super</span>
</span><span class='line'>        <span class="n">gist</span><span class="p">,</span> <span class="n">file</span> <span class="o">=</span> <span class="n">parts</span><span class="o">[</span><span class="mi">1</span><span class="o">].</span><span class="n">strip</span><span class="p">,</span> <span class="n">parts</span><span class="o">[</span><span class="mi">2</span><span class="o">].</span><span class="n">strip</span>
</span><span class='line'>        <span class="n">script_url</span> <span class="o">=</span> <span class="n">script_url_for</span> <span class="n">gist</span><span class="p">,</span> <span class="n">file</span>
</span><span class='line'>        <span class="n">json</span> <span class="o">=</span> <span class="n">get_cached_gist</span><span class="p">(</span><span class="n">gist</span><span class="p">,</span> <span class="n">file</span><span class="p">)</span> <span class="o">||</span> <span class="n">get_gist_from_web</span><span class="p">(</span><span class="n">gist</span><span class="p">,</span> <span class="n">file</span><span class="p">)</span>
</span><span class='line'>        <span class="n">files</span> <span class="o">=</span> <span class="n">json</span><span class="o">[</span><span class="s2">&quot;files&quot;</span><span class="o">]</span>
</span><span class='line'>        <span class="n">url</span> <span class="o">=</span> <span class="n">json</span><span class="o">[</span><span class="s2">&quot;html_url&quot;</span><span class="o">]</span>
</span><span class='line'>        <span class="n">description</span> <span class="o">=</span> <span class="n">json</span><span class="o">[</span><span class="s2">&quot;description&quot;</span><span class="o">]</span>
</span><span class='line'>        <span class="n">source</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span class='line'>        <span class="n">files</span><span class="o">.</span><span class="n">each</span> <span class="k">do</span> <span class="o">|</span> <span class="nb">name</span><span class="p">,</span> <span class="n">info</span><span class="o">|</span>
</span><span class='line'>          <span class="k">if</span> <span class="o">!</span><span class="n">file</span><span class="o">.</span><span class="n">empty?</span> <span class="o">&amp;&amp;</span> <span class="n">file</span> <span class="o">!=</span> <span class="nb">name</span>
</span><span class='line'>            <span class="k">next</span>
</span><span class='line'>          <span class="k">end</span>
</span><span class='line'>          <span class="n">code</span> <span class="o">=</span> <span class="n">info</span><span class="o">[</span><span class="s2">&quot;content&quot;</span><span class="o">]</span>
</span><span class='line'>          <span class="n">lang</span> <span class="o">=</span> <span class="n">info</span><span class="o">[</span><span class="s2">&quot;language&quot;</span><span class="o">].</span><span class="n">downcase</span>
</span><span class='line'>          <span class="k">if</span> <span class="n">lang</span> <span class="o">==</span> <span class="s2">&quot;markdown&quot;</span>
</span><span class='line'><span class="c1"># マークダウンのレンダリング</span>
</span><span class='line'><span class="c1">#            source += pre_filter(code)</span>
</span><span class='line'><span class="c1">#            partial = Liquid::Template.parse(source)</span>
</span><span class='line'><span class="c1">#            context.stack do</span>
</span><span class='line'><span class="c1">#              partial.render(context)</span>
</span><span class='line'><span class="c1">#            end</span>
</span><span class='line'>          <span class="k">else</span>
</span><span class='line'>            <span class="n">caption</span> <span class="o">=</span> <span class="s2">&quot;&lt;figcaption&gt;&lt;span&gt;</span><span class="si">#{</span><span class="n">description</span><span class="si">}</span><span class="s2">&lt;/span&gt;&lt;a target=&#39;_blank&#39; href=&#39;</span><span class="si">#{</span><span class="n">url</span><span class="si">}</span><span class="s2">&#39;&gt;link&lt;/a&gt;&lt;/figcaption&gt;&quot;</span>
</span><span class='line'>            <span class="n">code</span> <span class="o">=</span> <span class="s2">&quot;&lt;figure class=&#39;code&#39;&gt;</span><span class="si">#{</span><span class="n">caption</span><span class="si">}#{</span><span class="n">highlight</span><span class="p">(</span><span class="n">code</span><span class="p">,</span> <span class="n">lang</span><span class="p">)</span><span class="si">}</span><span class="s2">&lt;/figure&gt;&quot;</span>
</span><span class='line'>            <span class="n">code</span> <span class="o">=</span> <span class="n">safe_wrap</span><span class="p">(</span><span class="n">code</span><span class="p">)</span>
</span><span class='line'>            <span class="n">code</span> <span class="o">=</span> <span class="n">context</span><span class="o">[</span><span class="s1">&#39;pygments_prefix&#39;</span><span class="o">]</span> <span class="o">+</span> <span class="n">code</span> <span class="k">if</span> <span class="n">context</span><span class="o">[</span><span class="s1">&#39;pygments_prefix&#39;</span><span class="o">]</span>
</span><span class='line'>            <span class="n">code</span> <span class="o">=</span> <span class="n">code</span> <span class="o">+</span> <span class="n">context</span><span class="o">[</span><span class="s1">&#39;pygments_suffix&#39;</span><span class="o">]</span> <span class="k">if</span> <span class="n">context</span><span class="o">[</span><span class="s1">&#39;pygments_suffix&#39;</span><span class="o">]</span>
</span><span class='line'>            <span class="n">source</span> <span class="o">+=</span> <span class="n">code</span>
</span><span class='line'>          <span class="k">end</span>
</span><span class='line'>        <span class="k">end</span>
</span><span class='line'>        <span class="n">source</span>
</span><span class='line'>      <span class="k">else</span>
</span><span class='line'>        <span class="s2">&quot;&quot;</span>
</span><span class='line'>      <span class="k">end</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">def</span> <span class="nf">script_url_for</span><span class="p">(</span><span class="n">gist_id</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>
</span><span class='line'>      <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://gist.github.com/</span><span class="si">#{</span><span class="n">gist_id</span><span class="si">}</span><span class="s2">.js&quot;</span>
</span><span class='line'>      <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">#{</span><span class="n">url</span><span class="si">}</span><span class="s2">?file=</span><span class="si">#{</span><span class="n">filename</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">unless</span> <span class="n">filename</span><span class="o">.</span><span class="n">nil?</span> <span class="ow">or</span> <span class="n">filename</span><span class="o">.</span><span class="n">empty?</span>
</span><span class='line'>      <span class="n">url</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">def</span> <span class="nf">get_gist_url_for</span><span class="p">(</span><span class="n">gist</span><span class="p">,</span>  <span class="n">file</span><span class="p">)</span>
</span><span class='line'>      <span class="s2">&quot;https://api.github.com/gists/</span><span class="si">#{</span><span class="n">gist</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">def</span> <span class="nf">cache</span><span class="p">(</span><span class="n">gist</span><span class="p">,</span> <span class="n">file</span><span class="p">,</span> <span class="n">json</span><span class="p">)</span>
</span><span class='line'>      <span class="n">cache_file</span> <span class="o">=</span> <span class="n">get_cache_file_for</span> <span class="n">gist</span><span class="p">,</span> <span class="n">file</span>
</span><span class='line'>      <span class="no">File</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">cache_file</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">do</span> <span class="o">|</span><span class="n">io</span><span class="o">|</span>
</span><span class='line'>        <span class="no">JSON</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">json</span><span class="p">,</span> <span class="n">io</span><span class="p">)</span>
</span><span class='line'>      <span class="k">end</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">def</span> <span class="nf">get_cached_gist</span><span class="p">(</span><span class="n">gist</span><span class="p">,</span> <span class="n">file</span><span class="p">)</span>
</span><span class='line'>      <span class="k">return</span> <span class="kp">nil</span> <span class="k">if</span> <span class="vi">@cache_disabled</span>
</span><span class='line'>      <span class="n">cache_file</span> <span class="o">=</span> <span class="n">get_cache_file_for</span> <span class="n">gist</span><span class="p">,</span> <span class="n">file</span>
</span><span class='line'>      <span class="c1">#data = File.read cache_file if File.exist? cache_file</span>
</span><span class='line'>      <span class="n">data</span> <span class="o">=</span> <span class="kp">nil</span>
</span><span class='line'>      <span class="k">if</span> <span class="no">File</span><span class="o">.</span><span class="n">exist?</span> <span class="n">cache_file</span>
</span><span class='line'>        <span class="nb">open</span><span class="p">(</span><span class="n">cache_file</span><span class="p">)</span> <span class="k">do</span> <span class="o">|</span><span class="n">io</span><span class="o">|</span>
</span><span class='line'>          <span class="n">data</span> <span class="o">=</span> <span class="no">JSON</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">io</span><span class="p">)</span>
</span><span class='line'>        <span class="k">end</span>
</span><span class='line'>      <span class="k">end</span>
</span><span class='line'>      <span class="n">data</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">def</span> <span class="nf">get_cache_file_for</span><span class="p">(</span><span class="n">gist</span><span class="p">,</span> <span class="n">file</span><span class="p">)</span>
</span><span class='line'>      <span class="n">bad_chars</span> <span class="o">=</span> <span class="sr">/[^a-zA-Z0-9\-_.]/</span>
</span><span class='line'>      <span class="n">gist</span>      <span class="o">=</span> <span class="n">gist</span><span class="o">.</span><span class="n">gsub</span> <span class="n">bad_chars</span><span class="p">,</span> <span class="s1">&#39;&#39;</span>
</span><span class='line'>      <span class="n">file</span>      <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">gsub</span> <span class="n">bad_chars</span><span class="p">,</span> <span class="s1">&#39;&#39;</span>
</span><span class='line'>      <span class="n">md5</span>       <span class="o">=</span> <span class="ss">Digest</span><span class="p">:</span><span class="ss">:MD5</span><span class="o">.</span><span class="n">hexdigest</span> <span class="s2">&quot;</span><span class="si">#{</span><span class="n">gist</span><span class="si">}</span><span class="s2">-</span><span class="si">#{</span><span class="n">file</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span class='line'>      <span class="no">File</span><span class="o">.</span><span class="n">join</span> <span class="vi">@cache_folder</span><span class="p">,</span> <span class="s2">&quot;</span><span class="si">#{</span><span class="n">gist</span><span class="si">}</span><span class="s2">-</span><span class="si">#{</span><span class="n">file</span><span class="si">}</span><span class="s2">-</span><span class="si">#{</span><span class="n">md5</span><span class="si">}</span><span class="s2">.cache&quot;</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">def</span> <span class="nf">http_get_data</span><span class="p">(</span><span class="n">uri</span><span class="p">)</span>
</span><span class='line'>      <span class="n">raw_uri</span>           <span class="o">=</span> <span class="no">URI</span><span class="o">.</span><span class="n">parse</span> <span class="n">uri</span>
</span><span class='line'>      <span class="n">proxy</span>             <span class="o">=</span> <span class="no">ENV</span><span class="o">[</span><span class="s1">&#39;http_proxy&#39;</span><span class="o">]</span>
</span><span class='line'>      <span class="k">if</span> <span class="n">proxy</span>
</span><span class='line'>        <span class="n">proxy_uri</span>       <span class="o">=</span> <span class="no">URI</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">proxy</span><span class="p">)</span>
</span><span class='line'>        <span class="n">https</span>           <span class="o">=</span> <span class="ss">Net</span><span class="p">:</span><span class="ss">:HTTP</span><span class="o">::</span><span class="no">Proxy</span><span class="p">(</span><span class="n">proxy_uri</span><span class="o">.</span><span class="n">host</span><span class="p">,</span> <span class="n">proxy_uri</span><span class="o">.</span><span class="n">port</span><span class="p">)</span><span class="o">.</span><span class="n">new</span> <span class="n">raw_uri</span><span class="o">.</span><span class="n">host</span><span class="p">,</span> <span class="n">raw_uri</span><span class="o">.</span><span class="n">port</span>
</span><span class='line'>      <span class="k">else</span>
</span><span class='line'>        <span class="n">https</span>           <span class="o">=</span> <span class="ss">Net</span><span class="p">:</span><span class="ss">:HTTP</span><span class="o">.</span><span class="n">new</span> <span class="n">raw_uri</span><span class="o">.</span><span class="n">host</span><span class="p">,</span> <span class="n">raw_uri</span><span class="o">.</span><span class="n">port</span>
</span><span class='line'>      <span class="k">end</span>
</span><span class='line'>      <span class="n">https</span><span class="o">.</span><span class="n">use_ssl</span>     <span class="o">=</span> <span class="kp">true</span>
</span><span class='line'>      <span class="n">https</span><span class="o">.</span><span class="n">verify_mode</span> <span class="o">=</span> <span class="ss">OpenSSL</span><span class="p">:</span><span class="ss">:SSL</span><span class="o">::</span><span class="no">VERIFY_NONE</span>
</span><span class='line'>      <span class="n">request</span>           <span class="o">=</span> <span class="ss">Net</span><span class="p">:</span><span class="ss">:HTTP</span><span class="o">::</span><span class="no">Get</span><span class="o">.</span><span class="n">new</span> <span class="n">raw_uri</span><span class="o">.</span><span class="n">request_uri</span>
</span><span class='line'>      <span class="n">data</span>              <span class="o">=</span> <span class="n">https</span><span class="o">.</span><span class="n">request</span> <span class="n">request</span>
</span><span class='line'>      <span class="k">if</span> <span class="n">data</span><span class="o">.</span><span class="n">code</span><span class="o">.</span><span class="n">to_i</span> <span class="o">!=</span> <span class="mi">200</span>
</span><span class='line'>        <span class="k">raise</span> <span class="no">RuntimeError</span><span class="p">,</span> <span class="s2">&quot;Gist replied with </span><span class="si">#{</span><span class="n">data</span><span class="o">.</span><span class="n">code</span><span class="si">}</span><span class="s2"> for </span><span class="si">#{</span><span class="n">uri</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span class='line'>      <span class="k">end</span>
</span><span class='line'>      <span class="n">data</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">def</span> <span class="nf">get_gist_from_web</span><span class="p">(</span><span class="n">gist</span><span class="p">,</span> <span class="n">file</span><span class="p">)</span>
</span><span class='line'>      <span class="n">gist_url</span>          <span class="o">=</span> <span class="n">get_gist_url_for</span> <span class="n">gist</span><span class="p">,</span> <span class="n">file</span>
</span><span class='line'>      <span class="n">data</span> <span class="o">=</span> <span class="n">http_get_data</span><span class="p">(</span><span class="n">gist_url</span><span class="p">)</span>
</span><span class='line'>      <span class="n">json</span> <span class="o">=</span> <span class="no">JSON</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">body</span><span class="p">)</span>
</span><span class='line'>      <span class="n">cache</span> <span class="n">gist</span><span class="p">,</span> <span class="n">file</span><span class="p">,</span> <span class="n">json</span> <span class="k">unless</span> <span class="vi">@cache_disabled</span>
</span><span class='line'>      <span class="n">json</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">class</span> <span class="nc">GistTagNoCache</span> <span class="o">&lt;</span> <span class="no">GistTag</span>
</span><span class='line'>    <span class="k">def</span> <span class="nf">initialize</span><span class="p">(</span><span class="n">tag_name</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">token</span><span class="p">)</span>
</span><span class='line'>      <span class="k">super</span>
</span><span class='line'>      <span class="vi">@cache_disabled</span> <span class="o">=</span> <span class="kp">true</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="ss">Liquid</span><span class="p">:</span><span class="ss">:Template</span><span class="o">.</span><span class="n">register_tag</span><span class="p">(</span><span class="s1">&#39;gist&#39;</span><span class="p">,</span> <span class="ss">Jekyll</span><span class="p">:</span><span class="ss">:GistTag</span><span class="p">)</span>
</span><span class='line'><span class="ss">Liquid</span><span class="p">:</span><span class="ss">:Template</span><span class="o">.</span><span class="n">register_tag</span><span class="p">(</span><span class="s1">&#39;gistnocache&#39;</span><span class="p">,</span> <span class="ss">Jekyll</span><span class="p">:</span><span class="ss">:GistTagNoCache</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>すると、以下の様な書式が使えるようになります。</p>

<p></p>

<pre><code>  {% gist 5672127 %}

  {% gist 13411532 some_gist_file_name.rb %}
</code></pre>

<p></p>

<p>参考:</p>

<p><a href="http://j5ik2o.me/blog/2013/05/10/gist-tag/" target="_blank">OctopressのGist Tagプラグインを改造してみた &ndash; じゅんいち☆かとうの技術日誌</a></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[MiddlemanでGitHub Pagesを構築してみた]]></title>
    <link href="http://syui.github.io/blog/2014/06/23/blog-github-middleman/"/>
    <updated>2014-06-23T00:00:00+09:00</updated>
    <id>http://syui.github.io/blog/2014/06/23/blog-github-middleman</id>
    <content type="html"><![CDATA[<p><img src="/images/more.png" alt="phoenix-power" align="left" width="100" height="100">Octopress よりも導入が簡単な Middleman を使ってみました。<!--more--><br clear="all"></p>

<h2>Middleman</h2>

<p><a href="http://middlemanapp.com/jp/" target="_blank"><a href="http://middlemanapp.com/jp/">http://middlemanapp.com/jp/</a></a></p>

<p><code>Middleman</code>とは、簡単に言うとページの構築をコマンドラインから簡単に行うためのものです。</p>

<p>ドキュメントが日本語で丁寧に書かれているため、使い方が分からないということは少ないと思いますが、基本的な使い方は、以下の通りです。</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;h1&gt;Web ページ作成の簡易化ツール Middleman のインストール&lt;/h1&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;<span class="nv">$ </span>gem install middleman
</span><span class='line'><span class="nv">$ </span>gem install middleman-blog&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;h1&gt;指定のディレクトリにテンプレートを作成するコマンド&lt;/h1&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;<span class="nv">$ </span>middleman init ~/hoge&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;h1&gt;現在のディレクトリにある <span class="nb">source</span> フォルダをプレビューを行うコマンド<span class="o">(</span>&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;http://localhost:4567/&quot;</span>&gt;http://localhost:4567/&lt;/a&gt;<span class="o">)</span>&lt;/h1&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;<span class="nv">$ </span>middleman server&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;h1&gt;現在ディレクトリの <span class="nb">source</span> フォルダ build フォルダ内に HTML 変換するコマンド&lt;/h1&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;<span class="nv">$ </span>middleman build
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>以下、自分がページを作った際の具体的な手順を紹介します。</p>

<h3>GitHub Pages の作成</h3>

<p>まずは、 Middleman を使ってできるページのソース群をホスティングするための <a href="https://pages.github.com/">GitHub Pages</a> を作りましょう。</p>

<p>ここでは、ユーザーページ(グループページも含む)、プロジェクトページがあるうちの、プロジェクトページを使用します。</p>

<p>それぞれのURLは、ユーザーページが<code>username.github.io</code>となっています。プロジェクトページが<code>username.github.io/reponame</code>となっています。</p>

<p>したがって、まずは、GitHub Pages(プロジェクトページ版) を作るために、新しいリポジトリを作成します。リポジトリ名はなんでもいいのですが、これが URL になります。ここでは、<code>middleman</code>としました。</p>

<p>次に、 <code>Settings &gt; GitHub Pages &gt; Automatic Page Generator</code>と進み、プロジェクトページを作成します。</p>

<p><img src="http://lh6.ggpht.com/-3AXQaZ_4ZNI/U6c4ROTiYVI/AAAAAAAAIcU/Bu5HEivnAYg/%2525E3%252582%2525B9%2525E3%252582%2525AF%2525E3%252583%2525AA%2525E3%252583%2525BC%2525E3%252583%2525B3%2525E3%252582%2525B7%2525E3%252583%2525A7%2525E3%252583%252583%2525E3%252583%252588.png"></p>

<p>プロジェクトページが作成されたら、<code>username.github.io/reponame</code>でアクセスできますので、アクセスしてみてください。</p>

<p>なお、私の場合は、以下のような URL になりました。</p>

<p><a href="http://syui.github.io/middleman" target="_blank"><a href="http://syui.github.io/middleman">http://syui.github.io/middleman</a></a></p>

<h3>Middleman のインストールと使用</h3>

<p>次に、 Middleman をインストールし、実際に使ってみます。</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>gem install middleman&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;<span class="nv">$ </span>gem install middleman-blog&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;<span class="nv">$ </span>middleman init ~/middleman&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;<span class="nv">$ </span><span class="nb">cd</span> !<span class="nv">$&lt;</span>/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;<span class="nv">$ </span>middleman server&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;<span class="nv">$ </span>middleman build
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<h3>Middleman を実行したフォルダに GitHub Pages をホスティングする</h3>

<p><div class='bogus-wrapper'><notextile><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span><span class="nb">echo</span> &amp;lsquo;gem &amp;ldquo;middleman-deploy&amp;rdquo;&amp;rsquo; &gt;&gt; Gemfile&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;<span class="nv">$ </span>bundle&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;<span class="nv">$ </span>vim config.rb
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>あとは、デプロイ自動化のための設定を書きます。以下を追記してください。</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'><figcaption><span>config.rb </span></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">configure</span> <span class="ss">:build</span> <span class="k">do</span>
</span><span class='line'>  <span class="n">activate</span> <span class="ss">:asset_host</span><span class="p">,</span> <span class="ss">:host</span> <span class="o">=&gt;</span> <span class="o">&amp;</span><span class="n">ldquo</span><span class="p">;</span><span class="o">/</span><span class="n">reponame</span><span class="o">&amp;</span><span class="n">rdquo</span><span class="p">;</span>
</span><span class='line'><span class="k">end</span><span class="o">&lt;</span><span class="sr">/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="sr">&lt;p&gt;activate :deploy do |deploy|</span>
</span><span class='line'><span class="sr">  deploy.build_before = true</span>
</span><span class='line'><span class="sr">  deploy.method = :git</span>
</span><span class='line'><span class="sr">  deploy.branch = &amp;lsquo;gh-pages&amp;rsquo;</span>
</span><span class='line'><span class="sr">end</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>ここで、<code>/reponame</code>は、私の場合、<code>/middleman</code>になりますね。</p>

<p>内容を見てわかると思いますが、リポジトリに GitHub Pages(プロジェクトページ) を作った場合、以下のコマンドで作成したページを編集できます。</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;h1&gt;リポジトリのクローン&lt;/h1&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;git clone &lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;https://github.com/syui/middleman&quot;</span>&gt;https://github.com/syui/middleman&lt;/a&gt;
</span><span class='line'><span class="nb">cd</span> !<span class="nv">$:</span>t&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;h1&gt;ブランチの確認&lt;/h1&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;<span class="nv">$ </span>git branch -r&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;h1&gt;ブランチを GitHub Pages に変更&lt;/h1&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;<span class="nv">$ </span>git checkout gh-pages
</span><span class='line'><span class="nv">$ </span>ls
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>つまり、 <code>middleman deploy</code>コマンドを使わなくても、ブランチを変更し、更にはそこにあるファイルを全て削除した上で、<code>~/middleman/build</code>フォルダ内にあるファイルを持ってきて<code>git push</code>すれば、 Middleman で作成したページを公開できるということです。</p>

<p>しかしそれでは面倒くさいので、上の作業を自動化するスクリプトを使ったほうがいいのです。当該スクリプトを使うには、設定ファイルに自身の設定を書けば良いわけですね。</p>

<p>さて、上の設定を書けば、以下のコマンドで、<code>./build</code>が<code>gh-pages</code>ブランチにデプロイされます。</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>middleman deploy
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>あとは、作成した GitHub Pages の URL にアクセスしてみればページが表示されているはずです。</p>

<p><code>username.github.io/reponame</code></p>

<h3>Middleman のテンプレート</h3>

<p>Middleman もいくつかのテンプレートがあるみたいです。</p>

<p><a href="http://directory.middlemanapp.com/#/templates/all" target="_blank"><a href="http://directory.middlemanapp.com/#/templates/all">http://directory.middlemanapp.com/#/templates/all</a></a></p>

<p>テンプレートを使いには、以下のコマンドのようにやります。</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>middleman init my_new_mobile_project &amp;mdash;template<span class="o">=</span>html5
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>せめてデモページヘの URL は載せておいてほしい&hellip;。これは、プレビューするまでわからないという感じなのでしょうか。</p>

<p>参考:</p>

<p><a href="http://www.adventar.org/calendars/251" target="_blank">Middleman Advent Calendar 2013 &ndash; Adventar</a></p>

<p><a href="http://d.hatena.ne.jp/osyo-manga/20140209/1391955805" target="_blank">middleman で構築したサイトを GitHub Pages で公開するまでの流れをまとめてみた &ndash; C++でゲームプログラミング</a></p>

<p><a href="http://nobuhito.github.io/env/2013/10/22/middleman/" target="_blank">GithubPagesとMiddlemanで技術系っぽいBLOGを始めて見る::Route4610</a></p>

<h3>Middleman Blog</h3>

<p>ブログも簡単に作成できます。具体的には、必要なモジュールをインストールした上で、<code>middleman init myproject --template=blog</code>コマンドとブログの設定を<code>config.rb</code>に書きます。</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'><figcaption><span>config.rb </span></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="no">Time</span><span class="o">.</span><span class="n">zone</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">ldquo</span><span class="p">;</span><span class="no">Tokyo</span><span class="o">&amp;</span><span class="n">rdquo</span><span class="p">;</span><span class="o">&lt;</span><span class="sr">/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="sr">&lt;p&gt;activate :blog do |blog|</span>
</span><span class='line'><span class="sr">  # blog.prefix = &amp;ldquo;blog&amp;rdquo;</span>
</span><span class='line'><span class="sr">  # blog.permalink = &amp;ldquo;:year/</span><span class="ss">:month</span><span class="o">/</span><span class="ss">:day</span><span class="o">/</span><span class="ss">:title</span><span class="o">.</span><span class="n">html</span><span class="o">&amp;</span><span class="n">rdquo</span><span class="p">;</span>
</span><span class='line'>  <span class="c1"># blog.sources = &amp;ldquo;:year-:month-:day-:title.html&amp;rdquo;</span>
</span><span class='line'>  <span class="c1"># blog.taglink = &amp;ldquo;tags/:tag.html&amp;rdquo;</span>
</span><span class='line'>  <span class="c1"># blog.layout = &amp;ldquo;layout&amp;rdquo;</span>
</span><span class='line'>  <span class="c1"># blog.summary_separator = /(READMORE)/</span>
</span><span class='line'>  <span class="c1"># blog.summary_length = 250</span>
</span><span class='line'>  <span class="c1"># blog.year_link = &amp;ldquo;:year.html&amp;rdquo;</span>
</span><span class='line'>  <span class="c1"># blog.month_link = &amp;ldquo;:year/:month.html&amp;rdquo;</span>
</span><span class='line'>  <span class="c1"># blog.day_link = &amp;ldquo;:year/:month/:day.html&amp;rdquo;</span>
</span><span class='line'>  <span class="c1"># blog.default_extension = &amp;ldquo;.markdown&amp;rdquo;&lt;/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="nb">p</span><span class="o">&gt;</span>  <span class="n">blog</span><span class="o">.</span><span class="n">tag_template</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">ldquo</span><span class="p">;</span><span class="n">tag</span><span class="o">.</span><span class="n">html</span><span class="o">&amp;</span><span class="n">rdquo</span><span class="p">;</span>
</span><span class='line'>  <span class="n">blog</span><span class="o">.</span><span class="n">calendar_template</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">ldquo</span><span class="p">;</span><span class="n">calendar</span><span class="o">.</span><span class="n">html</span><span class="o">&amp;</span><span class="n">rdquo</span><span class="p">;</span><span class="o">&lt;</span><span class="sr">/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="sr">&lt;p&gt;  # blog.paginate = true</span>
</span><span class='line'><span class="sr">  # blog.per_page = 10</span>
</span><span class='line'><span class="sr">  # blog.page_link = &amp;ldquo;page/</span><span class="ss">:num</span><span class="o">&amp;</span><span class="n">rdquo</span><span class="p">;</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>参考:</p>

<p><a href="http://rochas.cc/blog/2013/11/19/middleman-heroku.html" target="_blank">Middleman + Slim + Herokuでブログをつくりました &ndash; ROCHAS</a></p>
]]></content>
  </entry>
  
</feed>
